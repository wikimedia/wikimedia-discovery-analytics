[
    "PYSPARK_PYTHON=python3.7",
    "spark-submit",
    "--master",
    "yarn",
    "--conf",
    "spark.dynamicAllocation.maxExecutors=20",
    "--conf",
    "spark.executorEnv.REQUESTS_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt",
    "--conf",
    "spark.yarn.maxAppAttempts=1",
    "--conf",
    "spark.yarn.appMasterEnv.REQUESTS_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt",
    "--files",
    "hdfs:///wmf/data/discovery/ores/thresholds/articletopic_20210123.json#thresholds.json",
    "--py-files",
    "/srv/deployment/wikimedia/discovery/analytics/spark/wmf_spark.py",
    "--name",
    "[Search Airflow Job] Ores Predictions Hourly: Extract Articletopic Predictions",
    "--queue",
    "root.default",
    "/srv/deployment/wikimedia/discovery/analytics/spark/prepare_mw_rev_score.py",
    "--wikibase-item-partition",
    "discovery.wikibase_item/date=20010115",
    "--propagate-from",
    "enwiki",
    "--input-partition",
    "event.mediawiki_revision_score/@2021-01-24/2021-01-31",
    "--input-kind",
    "mediawiki_revision_score",
    "--output-partition",
    "discovery.ores_articletopic/year=2021/month=1/day=24/hour=0/source=ores_predictions_hourly",
    "--thresholds-path",
    "thresholds.json",
    "--prediction",
    "articletopic"
]