[
    "spark-submit",
    "--master",
    "yarn",
    "--conf",
    "spark.dynamicAllocation.maxExecutors=1",
    "--conf",
    "spark.yarn.maxAppAttempts=1",
    "--executor-cores",
    "8",
    "--executor-memory",
    "16g",
    "--driver-memory",
    "2g",
    "--name",
    "[Search Airflow Job] Process Sparql Query Hourly: Extract Queries",
    "--class",
    "org.wikidata.query.rdf.spark.analysis.QueryExtractor",
    "--queue",
    "root.default",
    "/srv/deployment/wikimedia/discovery/analytics/artifacts/rdf-spark-tools-latest-jar-with-dependencies.jar",
    "--input-table",
    "event.wdqs_external_sparql_query/year=2021/month=6/day=1/hour=0",
    "--output-table",
    "discovery.processed_external_sparql_query/year=2021/month=6/day=1/hour=0/wiki=wikidata"
]