[
    "PYSPARK_PYTHON=python3.7",
    "spark-submit",
    "--master",
    "yarn",
    "--conf",
    "spark.dynamicAllocation.maxExecutors=25",
    "--conf",
    "spark.executor.memoryOverhead=768",
    "--conf",
    "spark.executorEnv.REQUESTS_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt",
    "--conf",
    "spark.yarn.maxAppAttempts=1",
    "--conf",
    "spark.yarn.appMasterEnv.REQUESTS_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt",
    "--py-files",
    "/srv/deployment/wikimedia/discovery/analytics/spark/wmf_spark.py",
    "--name",
    "airflow-spark",
    "--queue",
    "root.default",
    "/srv/deployment/wikimedia/discovery/analytics/spark/convert_to_esbulk.py",
    "--config",
    "hourly",
    "--namespace-map-table",
    "discovery.cirrus_namespace_index_map",
    "--output",
    "hdfs:///wmf/data/discovery/transfer_to_es/date=20210124/freq=hourly/hour=0",
    "--datetime",
    "2021-01-24T00:00:00+00:00"
]