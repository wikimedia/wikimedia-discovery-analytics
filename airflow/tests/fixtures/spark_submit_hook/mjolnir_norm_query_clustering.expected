[
    "spark-submit",
    "--master",
    "yarn",
    "--conf",
    "spark.dynamicAllocation.maxExecutors=450",
    "--conf",
    "spark.executor.memory=2g",
    "--conf",
    "spark.jars.ivy=/tmp/airflow_ivy2",
    "--conf",
    "spark.jars.ivySettings=/etc/maven/ivysettings.xml",
    "--conf",
    "spark.pyspark.python=mjolnir_venv/bin/python",
    "--conf",
    "spark.sql.shuffle.partitions=1000",
    "--conf",
    "spark.yarn.maxAppAttempts=1",
    "--archives",
    "/srv/deployment/wikimedia/discovery/analytics/environments/mjolnir/venv.zip#mjolnir_venv",
    "--jars",
    "hdfs://analytics-hadoop/wmf/refinery/current/artifacts/refinery-hive-shaded.jar",
    "--packages",
    "org.wikimedia.search:mjolnir:0.7",
    "--driver-memory",
    "8g",
    "--name",
    "mjolnir-norm_query_clustering-20200108-spark",
    "--queue",
    "root.default",
    "/srv/deployment/wikimedia/discovery/analytics/spark/mjolnir-utilities.py",
    "norm_query_clustering",
    "--date",
    "20200108",
    "--output-path",
    "hdfs://pytest/path/to/mjolnir/query_clustering/date=20200108/algorithm=norm_query",
    "--brokers",
    "kafka-jumbo1001.eqiad.wmnet:9092,kafka-jumbo1002.eqiad.wmnet:9092,kafka-jumbo1003.eqiad.wmnet:9092",
    "--clicks-table",
    "mjolnir.query_clicks_ltr",
    "--min-sessions-per-query",
    "10",
    "--output-table",
    "mjolnir.query_clustering",
    "--top-n",
    "5",
    "--topic-request",
    "mjolnir.msearch-prod-request",
    "--topic-response",
    "mjolnir.msearch-prod-response"
]